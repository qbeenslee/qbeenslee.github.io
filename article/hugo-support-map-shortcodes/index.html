<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" lang="zh-cn"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no"><title>Hugo支持插入地图的shortcode | Hey sister</title><meta name="description" content="Hugo是什么? 本博客网站就是使用有Hugo渲染, 关于Hugo的介绍可以看这里Ps: 在Hugo面前, hexo的渲染速度就是一个渣渣! 概述 在博客网站里插入地图容器我觉得是一件很棒的功能, 比如分享自己的旅行记录.所以, 就有了这篇文章 ~ ~"><meta name="keywords" content="前端,地图,hugo,shortcodes"><meta name="author" content="qbeenslee"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" content="#ffffff"><meta property="og:title" content="Hugo支持插入地图的shortcode | Hey sister"><meta property="og:description" content="Hugo是什么? 本博客网站就是使用有Hugo渲染, 关于Hugo的介绍可以看这里Ps: 在Hugo面前, hexo的渲染速度就是一个渣渣! 概述 在博客网站里插入地图容器我觉得是一件很棒的功能, 比如分享自己的旅行记录.所以, 就有了这篇文章 ~ ~"><meta property="og:url" content="https://qbeenslee.com/article/hugo-support-map-shortcodes/"><meta property="og:site_name" content="Hey sister"><meta property="og:type" content="article"><meta property="article:section" content="Article"><meta property="article:tag" content="前端"><meta property="article:tag" content="地图"><meta property="article:tag" content="hugo"><meta property="article:tag" content="shortcodes"><meta property="article:published_time" content="2019-02-22T20:10:40&#43;08:00"><meta property="article:modified_time" content="2019-02-22T20:10:40&#43;08:00"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@"><meta name="twitter:creator" content="@"><link rel="alternate" type="application/rss+xml" title="Hey sister" href="https://qbeenslee.com/index.xml"><link rel="stylesheet" href="https://qbeenslee.com/css/main.css"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="manifest" href="/site.webmanifest"><script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js" type="text/javascript"></script><script src="https://cdn.jsdelivr.net/jquery.lazyload/1.9.3/jquery.lazyload.min.js" type="text/javascript"></script><script type="text/javascript" src="https://qbeenslee.com/js/leaflet.js"></script><link rel="stylesheet" href="https://qbeenslee.com/css/leaflet.css"></head><body data-spy="scroll" data-target="#content-toc-tree" data-offset="90"><link rel="stylesheet" href="https://qbeenslee.com/lib/photoswipe/photoswipe.min.css"><link rel="stylesheet" href="https://qbeenslee.com/lib/photoswipe/default-skin/default-skin.min.css"><div class="pswp" tabindex="-1" role="dialog" aria-hidden="true"><div class="pswp__bg"></div><div class="pswp__scroll-wrap"><div class="pswp__container"><div class="pswp__item"></div><div class="pswp__item"></div><div class="pswp__item"></div></div><div class="pswp__ui pswp__ui--hidden"><div class="pswp__top-bar"><div class="pswp__counter"></div> <button class="pswp__button pswp__button--close" title="Close (Esc)"></button> <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button> <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class="pswp__preloader"><div class="pswp__preloader__icn"><div class="pswp__preloader__cut"><div class="pswp__preloader__donut"></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class="pswp__share-tooltip"></div></div> <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button> <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class="pswp__caption"><div class="pswp__caption__center"></div></div></div></div></div><header id="header" class="auto_header unselectable opaqueHeader" style="top:0;position:fixed;z-index:9999"><div class="site"><a href="/"><div class="title">Hey sister</div></a></div><div id="nav-bar"><nav class="nav-item"> <a class="nav-color-normal" href="/bb/">小声BB</a></nav><nav class="nav-item dropdown"> <a class="dropbtn nav-color-normal">关于<span class="caret"></span></a><div class="dropdown-content"> <a href="/about/">关于我</a> <a href="/friends/">友情链接</a> <a href="/website-building/">技术说明</a> <a href="/copyright/">版权声明</a></div></nav></div></header><main style="background-color:#fff"><div id="page" class="vertical-safe"><div class="page-wrap"><div class="middle-side horizontal-safe"><article><div class="article-header"><h1 class="title">HUGO支持插入地图的SHORTCODE</h1><span class="subtitle">2019年2月22日 20:10</span></div><div class="content"><p></p><figure class="image-label"><img data-original="https://d33wubrfki0l68.cloudfront.net/30790d6888bd8af863fb2b5c33a7f337cdbda243/4e867/images/hugo-logo-wide.svg" alt="Hugo logo" width="400px" height="150px" class="nozoom"><figcaption>Hugo logo</figcaption></figure><p></p><blockquote><p>Hugo是什么? 本博客网站就是使用有Hugo渲染, 关于Hugo的介绍可以看<a href="https://gohugo.io">这里</a></p><p>Ps: 在Hugo面前, hexo的渲染速度就是一个<strong>渣渣</strong>!</p></blockquote><h2 id="概述">概述</h2><p>在博客网站里插入地图容器我觉得是一件很棒的功能, 比如分享自己的旅行记录.<br> 所以, 就有了这篇文章 ~ ~</p><p><strong>大体实现</strong></p><div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">依赖框架: leaflet.js
地图源  : openstreetmap.org
实现方式: hugo shortcode
</code></pre></div><h2 id="效果">效果</h2><div class="map-box"><div id="map-120.12887-30.26833" style="max-width:100%;height:320px"></div></div><script>var mymap=L.map("map-120.12887-30.26833",{attributionControl:!1}).setView(["30.26833","120.12887"],16);L.tileLayer("http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{}).addTo(mymap);var marker=L.marker(["30.26833","120.12887"]).addTo(mymap);marker.bindPopup("这里是黄龙体育馆").openPopup()</script><p><strong>markdown文档插入语句</strong></p><pre><code class="language-hugo" data-lang="hugo">{{ &lt;map h=&quot;320px&quot; pos=&quot;120.12887,30.26833&quot; zoom=&quot;16&quot; alt=&quot;这里是黄龙体育馆&quot;&gt; }}
</code></pre><blockquote><p><code>{{</code>和<code>}}</code>内两端的空格去掉</p></blockquote><h2 id="实现">实现</h2><h3 id="模板文件">模板文件</h3><p>创建<code>shortcodes</code>模板文件 <code>layouts/shortcodes/map.html</code>, 如下:</p><div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">{{- if .IsNamedParams -}}
{{- $mapPosition := (split (.Get &#34;pos&#34;) &#34;,&#34;) -}}
{{- $mapLon := default 120 (index $mapPosition 0) -}}
{{- $mapLat := default 30 (index $mapPosition 1) -}}
{{- $mapWidth := default &#34;100%&#34; (.Get &#34;w&#34;) -}}
{{- $mapHeight := default &#34;360px&#34; (.Get &#34;h&#34;) -}}
&lt;<span style="color:#062873;font-weight:700">div</span> <span style="color:#4070a0">class</span><span style="color:#666">=</span><span style="color:#4070a0">&#34;map-box&#34;</span>&gt;
&lt;<span style="color:#062873;font-weight:700">div</span> <span style="color:#4070a0">id</span><span style="color:#666">=</span><span style="color:#4070a0">&#34;map-{{$mapLon}}-{{$mapLat}}&#34;</span> <span style="color:#4070a0">style</span><span style="color:#666">=</span><span style="color:#4070a0">&#34;max-width:{{$mapWidth}};height:{{$mapHeight}};&#34;</span>&gt;&lt;/<span style="color:#062873;font-weight:700">div</span>&gt;
&lt;/<span style="color:#062873;font-weight:700">div</span>&gt;
&lt;<span style="color:#062873;font-weight:700">script</span>&gt;
    <span style="color:#007020;font-weight:700">var</span> mymap <span style="color:#666">=</span> L.map(<span style="color:#4070a0">&#39;map-{{$mapLon}}-{{$mapLat}}&#39;</span>, { attributionControl<span style="color:#666">:</span><span style="color:#007020;font-weight:700">false</span> }).setView([{{$mapLat}},{{$mapLon}}], {{ <span style="color:#007020;font-weight:700">if</span> .Get <span style="color:#4070a0">&#34;zoom&#34;</span> }}{{ <span style="color:#007020;font-weight:700">int</span> (.Get <span style="color:#4070a0">&#34;zoom&#34;</span>) }}{{ <span style="color:#007020;font-weight:700">else</span> }}<span style="color:#40a070">16</span>{{ end }});
    L.tileLayer(<span style="color:#4070a0">&#39;http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png&#39;</span>, {}).addTo(mymap);
	{{ <span style="color:#007020;font-weight:700">if</span> .Get <span style="color:#4070a0">&#34;alt&#34;</span> }}
    {{ <span style="color:#007020;font-weight:700">if</span> and (.Get <span style="color:#4070a0">&#34;altLat&#34;</span>) (.Get <span style="color:#4070a0">&#34;altLon&#34;</span>) }}
	<span style="color:#007020;font-weight:700">var</span> marker <span style="color:#666">=</span> L.marker([{{.Get <span style="color:#4070a0">&#34;altLat&#34;</span>}}, {{.Get <span style="color:#4070a0">&#34;altLon&#34;</span>}}]).addTo(mymap);
    {{ <span style="color:#007020;font-weight:700">else</span> }}
    <span style="color:#007020;font-weight:700">var</span> marker <span style="color:#666">=</span> L.marker([{{$mapLat}},{{$mapLon}}]).addTo(mymap);
	{{ end }}
	marker.bindPopup(<span style="color:#4070a0">&#34;{{.Get &#34;</span>alt<span style="color:#4070a0">&#34; }}&#34;</span>).openPopup();	
	{{ end }}
&lt;/<span style="color:#062873;font-weight:700">script</span>&gt;
{{- end -}}
</code></pre></div><h3 id="依赖">依赖</h3><p>在 leafletjs下载页<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup>获取相应的<code>js</code>, <code>css</code>, <code>image</code>文件, 存放在主题<code>static</code>目录下:</p><div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">static
├── css
│   ├── images
│   │   ├── layers-2x.png
│   │   ├── layers.png
│   │   ├── marker-icon-2x.png
│   │   ├── marker-icon.png
│   │   └── marker-shadow.png
│   ├── leaflet.css
├── js
     └── leaflet.js
</code></pre></div><p>在<code>&lt;head&gt;</code>中引入文件:</p><div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">&lt;<span style="color:#062873;font-weight:700">script</span> <span style="color:#4070a0">type</span><span style="color:#666">=</span><span style="color:#4070a0">&#34;text/javascript&#34;</span> <span style="color:#4070a0">src</span><span style="color:#666">=</span><span style="color:#4070a0">&#34;/js/leaflet.js&#34;</span>&gt;&lt;/<span style="color:#062873;font-weight:700">script</span>&gt;
&lt;<span style="color:#062873;font-weight:700">link</span> <span style="color:#4070a0">rel</span><span style="color:#666">=</span><span style="color:#4070a0">&#34;stylesheet&#34;</span> <span style="color:#4070a0">href</span><span style="color:#666">=</span><span style="color:#4070a0">&#34;/css/leaflet.css&#34;</span>/&gt;
</code></pre></div><h3 id="参数说明">参数说明</h3><div class="table-wrapper"><table><thead><tr><th>字段</th><th>含义</th><th>必填</th><th>备注</th></tr></thead><tbody><tr><td>h</td><td>high, 容易的高度</td><td></td><td></td></tr><tr><td>w</td><td>width, 容器的宽度</td><td></td><td></td></tr><tr><td>pos</td><td>position, 地理坐标</td><td>✓</td><td>&ldquo;经度,维度&rdquo;</td></tr><tr><td>zoom</td><td>缩放系数</td><td></td><td>默认16, 范围: 1~18</td></tr><tr><td>alt</td><td>alert, 弹出框文本</td><td></td><td>没有指定位置则为中心点</td></tr><tr><td>altLan</td><td>alert的经度</td><td></td><td></td></tr><tr><td>altLat</td><td>alert的维度</td><td></td><td></td></tr></tbody></table></div><div class="footnotes" role="doc-endnotes"><hr><ol><li id="fn:1" role="doc-endnote"><p><a href="https://leafletjs.com/download.html">https://leafletjs.com/download.html</a> <a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p></li></ol></div><div class="article-copyright"><p>文章作者: <a href="https://qbeenslee.com/article/hugo-support-map-shortcodes/"><i>qbeenslee</i></a></p> <a href="/copyright/"><img src="/img/cc-by-nc-nd.svg" height="20px" width="93px" class="nozoom"></a></div></div></article></div><div class="comment-wrap horizontal-safe" style="padding-left:20px;padding-right:20px"><script src="https://utteranc.es/client.js" repo="qbeenslee/comments.qbeenslee.com" issue-term="pathname" theme="github-light" crossorigin="anonymous" async></script></div><div id="content-toc-box" class="content-toc-box unselectable" style="height:calc(80% - 60px);right:calc(50% - 720px)"><div class="content-toc" id="content-toc"><div class="wrap"><ul id="content-toc-tree"><li class="toc-node node-h2"> <a class="toc-link" href="#%e6%a6%82%e8%bf%b0" title="概述"><span>概述</span></a></li><li class="toc-node node-h2"> <a class="toc-link" href="#%e6%95%88%e6%9e%9c" title="效果"><span>效果</span></a></li><li class="toc-node node-h2"> <a class="toc-link" href="#%e5%ae%9e%e7%8e%b0" title="实现"><span>实现</span></a></li><li class="toc-node node-h3"> <a class="toc-link" href="#%e6%a8%a1%e6%9d%bf%e6%96%87%e4%bb%b6" title="模板文件"><span>模板文件</span></a></li><li class="toc-node node-h3"> <a class="toc-link" href="#%e4%be%9d%e8%b5%96" title="依赖"><span>依赖</span></a></li><li class="toc-node node-h3"> <a class="toc-link" href="#%e5%8f%82%e6%95%b0%e8%af%b4%e6%98%8e" title="参数说明"><span>参数说明</span></a></li></ul></div></div></div></div></div></main><footer class="section site_footer_grap unselectable"><div class="has-text-centered"><p>&copy; Qbeenslee 2020</p></div></footer><script type="text/javascript" src="https://gitee.com/qbeenslee/qbeenslee.com/raw/master/js/main.js"></script><script type="text/javascript" src="https://qbeenslee.com/js/load-photoswipe.js"></script><script type="text/javascript" src="https://qbeenslee.com/lib/photoswipe/photoswipe.min.js"></script><script type="text/javascript" src="https://qbeenslee.com/lib/photoswipe/photoswipe-ui-default.min.js"></script><script type="text/javascript" src="https://qbeenslee.com/js/scrollspy.js"></script><script type="text/javascript" src="https://qbeenslee.com/js/jquery.smooth-scroll.js"></script><script type="text/javascript">var imgs=$("img");imgs.on("contextmenu",function(){return!1}),imgs.on("dragstart",function(){return!1})</script><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?58b3c65a09f5aacd0e62efe29897c7e4";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script></body></html>