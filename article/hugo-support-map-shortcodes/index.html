<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" lang="zh-Hans"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no"><title>Hugo支持插入地图的shortcode | Hey sister</title><meta name="description" content="Hugo是什么? 本博客网站就是使用有Hugo渲染, 关于Hugo的介绍可以看这里 Ps: 在Hugo面前, hexo的渲染速度就是一个渣渣!概述 在博客网站里插入地图容器我觉得是一件很棒的功能, 比"><meta name="keywords" content="前端,地图,hugo,shortcodes"><meta name="author" content="qbeenslee"><meta name="msapplication-TileColor" content="#ffffff"><meta name="theme-color" content="#ffffff"><meta property="theme-config" content="protectImage,list"><meta property="og:title" content="Hugo支持插入地图的shortcode | Hey sister"><meta property="og:description" content="Hugo是什么? 本博客网站就是使用有Hugo渲染, 关于Hugo的介绍可以看这里 Ps: 在Hugo面前, hexo的渲染速度就是一个渣渣!概述 在博客网站里插入地图容器我觉得是一件很棒的功能, 比"><meta property="og:url" content="https://qbeenslee.com/article/hugo-support-map-shortcodes/"><meta property="og:site_name" content="Hey sister"><meta property="og:type" content="article"><meta property="article:section" content="Article"><meta property="article:tag" content="前端"><meta property="article:tag" content="地图"><meta property="article:tag" content="hugo"><meta property="article:tag" content="shortcodes"><meta property="article:published_time" content="2019-02-22T20:10:40&#43;08:00"><meta property="article:modified_time" content="2019-02-22T20:10:40&#43;08:00"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@"><meta name="twitter:creator" content="@"><link rel="alternate" type="application/rss+xml" title="Hey sister" href="https://qbeenslee.com/index.xml"><link rel="stylesheet" href="https://qbeenslee.com/css/main-5ac0a20209.css"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="manifest" href="/site.webmanifest"><script src="https://qbeenslee.com/js/darkmode-09dcfb2235.js" type="text/javascript"></script><script src="https://ajax.aspnetcdn.com/ajax/jquery/jquery-3.6.0.min.js" type="text/javascript"></script><script src="https://cdn.jsdelivr.net/npm/lazyload@2.0.0-rc.2/lazyload.min.js" type="text/javascript"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.8.0/leaflet.min.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.8.0/leaflet.min.css"></head><body style="background-color:var(--bg)"><header id="header" class="auto_header nav-opaque" style="top:0;position:fixed;z-index:1100"><div id="navigation-bar" class="unselectable flex"><div class="nav-left"><div class="logo"><a class="nav-with-shadow nav-color-subject" href="/">Hey sister</a></div></div><div class="nav-middle horizontal-scroll"><nav><div class="nav-item"> <a class="nav-color-normal" href="/bb/">小声BB</a></div><div class="nav-item dropdown"> <a class="dropbtn nav-color-normal">归档<span class="caret"></span></a><div class="dropdown-content"> <a href="/archives/">全部</a> <a href="/categories/">类目</a> <a href="/tags/">标签</a></div></div><div class="nav-item dropdown"> <a class="dropbtn nav-color-normal">工具<span class="caret"></span></a><div class="dropdown-content"> <a href="https://json.qbeenslee.com">JSON</a> <a href="/article/test/">测试</a> <a href="/index.xml">订阅</a></div></div><div class="nav-item dropdown"> <a class="dropbtn nav-color-normal">关于<span class="caret"></span></a><div class="dropdown-content"> <a href="/about/me/">关于我</a> <a href="/friends/">友情链接</a> <a href="/about/website/">技术说明</a> <a href="/copyright/">版权声明</a> <a href="/privacy/">隐私条款</a> <a href="https://qbeenslee.com/hugo-theme-fragment/">帮助文档</a></div></div></nav></div><div class="nav-right"><div class="nav-item" title="搜索"><div class="search-button nav-with-shadow nav-color-subject"><i onclick="toggleSearch()" class="icon large search"></i></div><div class="search-box"><div class="search"><div class="input"> <input class="prompt" maxlength="1000" autocomplete="off" type="text" placeholder="搜索"></div><div class="results"></div></div></div></div><div class="nav-item" title="夜晚模式"><div class="nav-with-shadow nav-color-subject"><i onclick="toggleDarkmode()" class="icon large" id="darkmode-switcher"></i></div></div></div></div></header><main style="background-color:var(--bg)" class="page"><div id="page"><div class="horizontal-safe vertical-safe"><div class="page-wrapper"><div class="middle-side"><article><div class="article-header"><h1 class="title">Hugo支持插入地图的shortcode</h1> <span class="subtitle">2019年2月22日 20:10</span></div><div class="content" id="content"><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://raw.githubusercontent.com/qbeenslee/img/master/svg/hugologo.svg" alt="Hugo logo" width="400px" height="150px" class="nozoom"><blockquote><p>Hugo是什么? 本博客网站就是使用有Hugo渲染, 关于Hugo的介绍可以看<a href="https://gohugo.io" target="_blank">这里</a></p><p>Ps: 在Hugo面前, hexo的渲染速度就是一个<strong>渣渣</strong>!</p></blockquote><h2 id="概述">概述</h2><p>在博客网站里插入地图容器我觉得是一件很棒的功能, 比如分享自己的旅行记录.<br> 所以, 就有了这篇文章 ~ ~</p><p><strong>大体实现</strong></p><pre class="code-text">
<code data-lang="text">依赖框架: leaflet.js
地图源  : openstreetmap.org
实现方式: hugo shortcode
</code></pre><h2 id="示例">示例</h2><section class="switcher"><div class="switcher-wrapper"> <input type="radio" class="toggle" name="switcher-b7fc7" id="switcher-b7fc7-0" checked="checked"> <label for="switcher-b7fc7-0">效果</label><div class="switcher-content markdown-inner"><section class="map"><div class="map-box"><div id="map-lon120.12887-lat30.26833" style="max-width:100%;height:320px"></div></div></section><script>var mymap=L.map("map-lon120.12887-lat30.26833",{attributionControl:!1,zoomControl:!1}).setView(["30.26833","120.12887"],17);L.tileLayer("http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{}).addTo(mymap);var marker=L.marker(["30.26833","120.12887"]).addTo(mymap);marker.bindPopup("这里是黄龙体育馆").openPopup()</script></div> <span class="separator" aria-hidden="true">/</span> <input type="radio" class="toggle" name="switcher-b7fc7" id="switcher-b7fc7-1"> <label for="switcher-b7fc7-1">代码</label><div class="switcher-content markdown-inner"><div class="highlight"><pre tabindex="0" class="chroma code-html"><div class="prefix"></div><code class="language-html" data-lang="html"><span class="line"><span class="cl">{{ <span class="p">&lt;</span><span class="nt">map</span> <span class="na">h</span><span class="o">=</span><span class="s">&#34;320px&#34;</span> <span class="na">pos</span><span class="o">=</span><span class="s">&#34;120.12887,30.26833&#34;</span> <span class="na">zoom</span><span class="o">=</span><span class="s">&#34;17&#34;</span> <span class="na">alt</span><span class="o">=</span><span class="s">&#34;这里是黄龙体育馆&#34;</span><span class="p">&gt;</span> }}
</span></span></code></pre></div></div></div></section><h3 id="参数说明">参数说明</h3><div class="table-wrapper"><table><thead><tr><th>字段</th><th>含义</th><th>必填</th><th>备注</th></tr></thead><tbody><tr><td>h</td><td>high, 容易的高度</td><td></td><td>默认360px</td></tr><tr><td>w</td><td>width, 容器的宽度</td><td></td><td>默认为容器的宽</td></tr><tr><td>pos</td><td>position, 地理坐标</td><td>✓</td><td>&ldquo;经度,维度&rdquo;</td></tr><tr><td>zoom</td><td>缩放系数</td><td></td><td>默认16, 范围: 1~18</td></tr><tr><td>alt</td><td>alert, 弹出框文本</td><td></td><td>没有指定位置则为中心点</td></tr><tr><td>altLan</td><td>alert的经度</td><td></td><td></td></tr><tr><td>altLat</td><td>alert的维度</td><td></td><td></td></tr><tr><td>displayZoom</td><td>显示 <code>放大/缩小</code> 按钮, <code>true</code> 显示</td><td></td><td>默认隐藏</td></tr></tbody></table></div><h2 id="实现">实现</h2><h3 id="模板文件">模板文件</h3><p>创建<code>shortcodes</code>模板文件 <code>layouts/shortcodes/map.html</code>, 如下:</p><div class="highlight"><pre tabindex="0" class="chroma code-html"><div class="prefix"></div><code class="language-html" data-lang="html"><span class="line"><span class="cl">{{- if .IsNamedParams -}}
</span></span><span class="line"><span class="cl">{{- $mapPosition := (split (.Get &#34;pos&#34;) &#34;,&#34;) -}}
</span></span><span class="line"><span class="cl">{{- $mapLon := default 120 (index $mapPosition 0) -}}
</span></span><span class="line"><span class="cl">{{- $mapLat := default 30 (index $mapPosition 1) -}}
</span></span><span class="line"><span class="cl">{{- $mapWidth := default &#34;100%&#34; (.Get &#34;w&#34;) -}}
</span></span><span class="line"><span class="cl">{{- $mapHeight := default &#34;360px&#34; (.Get &#34;h&#34;) -}}
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;map-box&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;map-{{$mapLon}}-{{$mapLat}}&#34;</span> <span class="na">style</span><span class="o">=</span><span class="s">&#34;max-width:{{$mapWidth}};height:{{$mapHeight}};&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">var</span> <span class="nx">mymap</span> <span class="o">=</span> <span class="nx">L</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="s1">&#39;map-{{$mapLon}}-{{$mapLat}}&#39;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">attributionControl</span><span class="o">:</span><span class="kc">false</span> <span class="p">}).</span><span class="nx">setView</span><span class="p">([{{</span><span class="nx">$mapLat</span><span class="p">}},{{</span><span class="nx">$mapLon</span><span class="p">}}],</span> <span class="p">{{</span> <span class="k">if</span> <span class="p">.</span><span class="nx">Get</span> <span class="s2">&#34;zoom&#34;</span> <span class="p">}}{{</span> <span class="kr">int</span> <span class="p">(.</span><span class="nx">Get</span> <span class="s2">&#34;zoom&#34;</span><span class="p">)</span> <span class="p">}}{{</span> <span class="k">else</span> <span class="p">}}</span><span class="mi">16</span><span class="p">{{</span> <span class="nx">end</span> <span class="p">}});</span>
</span></span><span class="line"><span class="cl">    <span class="nx">L</span><span class="p">.</span><span class="nx">tileLayer</span><span class="p">(</span><span class="s1">&#39;http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png&#39;</span><span class="p">,</span> <span class="p">{}).</span><span class="nx">addTo</span><span class="p">(</span><span class="nx">mymap</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="p">{{</span> <span class="k">if</span> <span class="p">.</span><span class="nx">Get</span> <span class="s2">&#34;alt&#34;</span> <span class="p">}}</span>
</span></span><span class="line"><span class="cl">    <span class="p">{{</span> <span class="k">if</span> <span class="nx">and</span> <span class="p">(.</span><span class="nx">Get</span> <span class="s2">&#34;altLat&#34;</span><span class="p">)</span> <span class="p">(.</span><span class="nx">Get</span> <span class="s2">&#34;altLon&#34;</span><span class="p">)</span> <span class="p">}}</span>
</span></span><span class="line"><span class="cl">	<span class="kd">var</span> <span class="nx">marker</span> <span class="o">=</span> <span class="nx">L</span><span class="p">.</span><span class="nx">marker</span><span class="p">([{{.</span><span class="nx">Get</span> <span class="s2">&#34;altLat&#34;</span><span class="p">}},</span> <span class="p">{{.</span><span class="nx">Get</span> <span class="s2">&#34;altLon&#34;</span><span class="p">}}]).</span><span class="nx">addTo</span><span class="p">(</span><span class="nx">mymap</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">{{</span> <span class="k">else</span> <span class="p">}}</span>
</span></span><span class="line"><span class="cl">    <span class="kd">var</span> <span class="nx">marker</span> <span class="o">=</span> <span class="nx">L</span><span class="p">.</span><span class="nx">marker</span><span class="p">([{{</span><span class="nx">$mapLat</span><span class="p">}},{{</span><span class="nx">$mapLon</span><span class="p">}}]).</span><span class="nx">addTo</span><span class="p">(</span><span class="nx">mymap</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="p">{{</span> <span class="nx">end</span> <span class="p">}}</span>
</span></span><span class="line"><span class="cl">	<span class="nx">marker</span><span class="p">.</span><span class="nx">bindPopup</span><span class="p">(</span><span class="s2">&#34;{{.Get &#34;</span><span class="nx">alt</span><span class="s2">&#34; }}&#34;</span><span class="p">).</span><span class="nx">openPopup</span><span class="p">();</span>	
</span></span><span class="line"><span class="cl">	<span class="p">{{</span> <span class="nx">end</span> <span class="p">}}</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">{{- end -}}
</span></span></code></pre></div><h3 id="依赖">依赖</h3><p>在 leafletjs下载页<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup>获取相应的<code>js</code>, <code>css</code>, <code>image</code>文件, 存放在主题<code>static</code>目录下:</p><pre class="code-text">
<code data-lang="text">static
├── css
│   ├── images
│   │   ├── layers-2x.png
│   │   ├── layers.png
│   │   ├── marker-icon-2x.png
│   │   ├── marker-icon.png
│   │   └── marker-shadow.png
│   ├── leaflet.css
├── js
     └── leaflet.js
</code></pre><p>在<code>&lt;head&gt;</code>中引入文件:</p><div class="highlight"><pre tabindex="0" class="chroma code-html"><div class="prefix"></div><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;/js/leaflet-ab59f61559.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&#34;stylesheet&#34;</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;/css/leaflet-7be53ed796.css&#34;</span><span class="p">/&gt;</span>
</span></span></code></pre></div><div class="footnotes" role="doc-endnotes"><hr><ol><li id="fn:1"><p><a href="https://leafletjs.com/download.html" target="_blank">https://leafletjs.com/download.html</a> &#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p></li></ol></div><div class="article-copyright"><p>文章作者: <a href="https://qbeenslee.com/article/hugo-support-map-shortcodes/"><i>qbeenslee</i></a></p> <a href="/copyright/"><img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-src="https://qbeenslee.com/img/cc-by-nc-nd.svg" height="20px" width="93px" class="nozoom" alt="CC BY-NC 4.0" title="CC BY-NC 4.0"></a></div></div></article><div class="pagination-container flex flex-wrap"><div class="pagination-item pagination-item--previous"><a href="https://qbeenslee.com/article/a-sad-story-about-russia/"><div class="pagination-item-label"><svg width="10" height="16" viewBox="0 0 10 16" xmlns="http://www.w3.org/2000/svg"><polyline fill="none" vector-effect="non-scaling-stroke" points="8,2 2,8 8,14"></polyline></svg><span>上一篇</span></div><div class="pagination-item-title">终是去不了: 2019年俄罗斯极光之旅筹划文档</div></a></div><div class="pagination-item pagination-item--next"><a href="https://qbeenslee.com/article/building-an-android-hotfix-architecture/"><div class="pagination-item-label"> <span>下一篇</span><svg width="10" height="16" viewBox="0 0 10 16" xmlns="http://www.w3.org/2000/svg"><polyline fill="none" vector-effect="non-scaling-stroke" points="2,2 8,8 2,14"></polyline></svg></div><div class="pagination-item-title">Android热修复架构杂谈</div></a></div></div></div></div><div class="comment-wrap unselectable"><style>#vcomments .info,.at,.vcontent>a[href^="#"],.vcopy,.vlink,.vpower,.vsys{display:none!important}#vcomments{color:var(--text)}.v .vlist .vcard{padding-top:0!important}.v code,.v pre{font-size:100%!important}.vinput{border:none!important}.vheader{border-bottom:1px dashed var(--border-divide)!important}.v[data-class=v] .vwrap{border:1px solid var(--border-divide)!important}.v *{color:var(--text-suammary)!important}.v .vwrap{border:1px solid var(--border-light)!important}.v .vcards .vcard .vh{border-bottom:1px dashed var(--border-clear)!important}.v .vbtn{background:var(--block-similar)!important;border:1px solid var(--border-light)!important;color:var(--text-content)!important}</style><section class="section-content unselectable"><div id="vcomments" class="container"></div></section><script src="https://unpkg.com/valine@1.4.4/dist/Valine.min.js"></script><script>new Valine({el:"#vcomments",lang:"zh-cn",appId:"G3MMP8E4DNTqvCPV48o7Ph23-gzGzoHsz",appKey:"jYCgILtFpGK1vJUJSE5TtIIs",notify:!1,verify:!1,avatar:"hide",visitor:!1,recordIP:!1,placeholder:"随便说点啥~~"})</script></div></div></div></main><footer class="site_footer_grap unselectable"><div class="has-text-centered"><p>&copy;Qbeenslee 2023</p></div></footer><script type="text/javascript" src="https://qbeenslee.com/js/main-d45bbc8d2b.js"></script><script async type="text/javascript" src="https://hm.baidu.com/hm.js?58b3c65a09f5aacd0e62efe29897c7e4"></script></body></html>